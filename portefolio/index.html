<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Gabou Agenda 2025-2026</title>
<style>
body { font-family: Arial, sans-serif; background: linear-gradient(135deg,#1e3c72,#2a5298); color:#fff; margin:0; padding:0; }
h1 { text-align:center; font-size:2.5em; padding:20px; background:linear-gradient(90deg,#ff7e5f,#feb47b); color:#222; margin:0; letter-spacing:2px; border-bottom:2px solid #fff; }

.controls { display:flex; justify-content:center; flex-wrap:wrap; gap:10px; padding:15px; background: rgba(0,0,0,0.3);}
input, button { padding:10px; border-radius:8px; border:none; font-size:14px; }
input { min-width:180px; }
button { cursor:pointer; background:#ff6f61; color:#fff; transition:0.3s; }
button:hover { background:#ff3b2e; }

.calendar { width:100%; margin:20px auto; }
.month { margin-bottom:40px; border-radius:12px; padding:20px; color:#fff; box-shadow:0 4px 12px rgba(0,0,0,0.3); }
.month h2 { text-align:center; margin-bottom:15px; font-size:2em; color:#fff; text-shadow:2px 2px 4px #000; }

.weekdays, .days { display:grid; grid-template-columns:repeat(7,1fr); gap:6px; }
.weekdays div { text-align:center; font-weight:bold; padding:10px 0; background: rgba(255,255,255,0.2); border-radius:6px; }
.days div { min-height:90px; border-radius:10px; padding:6px; position:relative; overflow:auto; transition:0.2s; 
  background: rgba(255,255,255,0.1); backdrop-filter: blur(6px); cursor:text; }
.days div:hover { background: rgba(255,255,255,0.2); }
.date-num { font-weight:bold; font-size:1.2em; margin-bottom:4px; display:block; }

#notesList { max-width:900px; margin:20px auto; padding:15px; background:rgba(0,0,0,0.3); border-radius:12px; display:none; }
#notesList h2 { text-align:center; margin:10px 0; }
.note-item { background:#fff; color:#000; padding:8px; margin:5px 0; border-radius:8px; display:flex; justify-content:space-between; align-items:center; }
.note-item span { font-size:0.9em; }
.note-item button { background:#ff3b2e; padding:5px 10px; border-radius:6px; }
.highlight { outline:3px solid #00ffcc; }
</style>
</head>
<body>

<h1>üìÖ Gabou Agenda 2025-2026</h1>

<div class="controls">
  <input type="date" id="noteDate" placeholder="Choisir une date">
  <input type="text" id="noteText" placeholder="√âcrire une note...">
  <button onclick="ajouterNote()">‚ûï Ajouter</button>
  <input type="text" id="searchKeyword" placeholder="Rechercher dans calendrier...">
  <button onclick="chercherNote()">üîé Aller √† la note</button>
  <button onclick="supprimerTout()">üóëÔ∏è Supprimer tout</button>
  <button onclick="toggleListe()">üìã Voir/Masquer la liste</button>
</div>

<div id="notesList">
  <h2>üìù Liste des notes</h2>
  <input type="text" id="listSearch" placeholder="Rechercher dans la liste..." onkeyup="rechercherDansListe()">
  <div id="listContent"></div>
</div>

<div id="calendar" class="calendar"></div>

<script>
const notes = JSON.parse(localStorage.getItem('agendaNotes')||'{}');

function genererCalendrier(){
  const moisNoms=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];
  const joursNoms=["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"];
  const calendrier=document.getElementById("calendar");
  calendrier.innerHTML="";

  for(let annee of [2025,2026]){
    let debutMois=(annee===2025)?7:0;
    for(let m=debutMois;m<12;m++){
      let moisDiv=document.createElement("div");
      moisDiv.className="month";
      moisDiv.style.background=`linear-gradient(120deg,hsl(${m*30},70%,55%),hsl(${m*30+60},70%,45%))`;

      let titre=document.createElement("h2");
      titre.textContent=moisNoms[m]+" "+annee;
      moisDiv.appendChild(titre);

      let semaine=document.createElement("div");
      semaine.className="weekdays";
      joursNoms.forEach(j=>{let d=document.createElement("div");d.textContent=j;semaine.appendChild(d);});
      moisDiv.appendChild(semaine);

      let jours=document.createElement("div");
      jours.className="days";
      let premierJour=new Date(annee,m,1).getDay();
      if(premierJour===0) premierJour=7;
      for(let i=1;i<premierJour;i++) jours.appendChild(document.createElement("div"));

      let nbJours=new Date(annee,m+1,0).getDate();
      for(let j=1;j<=nbJours;j++){
        let caseJour=document.createElement("div");
        caseJour.contentEditable=true;
        caseJour.dataset.key=`${annee}-${String(m+1).padStart(2,"0")}-${String(j).padStart(2,"0")}`;
        caseJour.innerHTML=`<span class="date-num">${j}</span>` + (notes[caseJour.dataset.key]||"");

        caseJour.addEventListener('input',()=>{
          notes[caseJour.dataset.key]=caseJour.innerHTML.replace(/<span class="date-num">.*?<\/span>/,'').trim();
          localStorage.setItem('agendaNotes',JSON.stringify(notes));
        });

        jours.appendChild(caseJour);
      }

      moisDiv.appendChild(jours);
      calendrier.appendChild(moisDiv);
    }
  }
  afficherListeNotes();
}

function ajouterNote(){
  let date=document.getElementById("noteDate").value;
  let texte=document.getElementById("noteText").value.trim();
  if(!date||!texte) return;
  if(!notes[date]) notes[date]=[];
  notes[date].push(texte);
  localStorage.setItem('agendaNotes',JSON.stringify(notes));
  document.getElementById("noteText").value="";
  genererCalendrier();
}

function chercherNote(){
  let mot=document.getElementById("searchKeyword").value.trim().toLowerCase();
  if(!mot) return;
  document.querySelectorAll('.highlight').forEach(el=>el.classList.remove('highlight'));

  for(let d in notes){
    if(notes[d].some(n=>n.toLowerCase().includes(mot))){
      let caseEl=Array.from(document.querySelectorAll('.days div')).find(div=>{
        let dateNum=div.querySelector('.date-num');
        if(!dateNum) return false;
        let moisParent=div.closest('.month').querySelector('h2').textContent.split(' ')[0];
        let anneeParent=div.closest('.month').querySelector('h2').textContent.split(' ')[1];
        let moisIndex=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"].indexOf(moisParent)+1;
        return d===`${anneeParent}-${String(moisIndex).padStart(2,'0')}-${String(dateNum.textContent).padStart(2,'0')}`;
      });
      if(caseEl){caseEl.scrollIntoView({behavior:'smooth', block:'center'});caseEl.classList.add('highlight');}
      break;
    }
  }
}

function supprimerTout(){
  if(confirm("Supprimer toutes les notes ?")){
    for(let d in notes) delete notes[d];
    localStorage.setItem('agendaNotes',JSON.stringify(notes));
    genererCalendrier();
  }
}

function toggleListe(){
  let bloc=document.getElementById("notesList");
  bloc.style.display=(bloc.style.display==="none"||bloc.style.display==="")?"block":"none";
}

function afficherListeNotes(){
  let cont=document.getElementById("listContent");
  cont.innerHTML="";
  for(let d in notes){
    notes[d].forEach((n,i)=>{
      let div=document.createElement("div");
      div.className="note-item";
      div.innerHTML=`<span><b>${d}</b> ‚Üí ${n}</span> <button onclick="supprimerUne('${d}',${i})">‚ùå</button>`;
      cont.appendChild(div);
    });
  }
}

function rechercherDansListe(){
  let mot=document.getElementById("listSearch").value.toLowerCase();
  document.querySelectorAll("#listContent .note-item").forEach(item=>{
    item.style.display=item.textContent.toLowerCase().includes(mot)?"flex":"none";
  });
}

function supprimerUne(date,index){
  notes[date].splice(index,1);
  if(notes[date].length===0) delete notes[date];
  localStorage.setItem('agendaNotes',JSON.stringify(notes));
  genererCalendrier();
}

genererCalendrier();
</script>
</body>
</html>
